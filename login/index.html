<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <title></title>

    <script src="_libs/jquery.js"></script>

    <link href="_libs/fomantic-ui/semantic.min.css" rel="stylesheet" />
    <script src="_libs/fomantic-ui/semantic.min.js"></script>

    <script src="_libs/vuejs/vue.min.js"></script>
    <script src="_libs/vuejs/vue-router.min.js"></script>

    <link href="_libs/datatables/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="_libs/datatables/jquery.dataTables.min.js"></script>
    <script src="_libs/datatables/dataTables.fixedColumns.min.js"></script>

    <style type="text/css">
        body {
            background-color: #f5f5f5;
        }

        #ui-app {
            height: 100vh;
        }

            #ui-app .ui-page {
                max-width: 450px;
                background-color: #fff;
            }

        .field {
            text-align: left;
        }
    </style>
</head>
<body>
    <div id="ui-app" class="ui middle aligned center aligned grid">
        <div class="column ui-page">
            <div class="ui form">
                <div class="ui error message"></div>
                <div class="ui stacked segment">
                    <div v-for="(field,index) in objForm.arr_fields"
                         v-if="field.str_kit === 'text'" :class="['field ___v-form-field-' + field.str_name, field.bit_required ? 'required' : '', field.bit_inline ? 'inline' : '']">
                        <label>{{field.str_caption}}</label>
                        <input type="text" :name="field.str_name" :placeholder="field.str_placeholder">
                    </div>
                    <div v-else-if="field.str_kit === 'checkbox'" :class="['field ___v-form-field-' + field.str_name, field.bit_required ? 'required':'', field.bit_inline ? 'inline' : '']">
                        <div class="ui checkbox">
                            <input type="checkbox" :name="field.str_name" tabindex="0" class="hidden">
                            <label>{{field.str_caption}}</label>
                        </div>
                    </div>
                    <div v-else class="required inline field">
                        Not A/B/C
                    </div>
                </div>
                <div class="ui primary submit button">Submit</div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        new Vue({
            el: '#ui-app',
            data: function () {
                return {
                    objForm: {
                        str_title: '',
                        arr_fields: [
                            {
                                str_name: 'field-1',
                                str_caption: 'Last name',
                                str_placeholder: 'Full name',
                                str_kit: 'text',
                                bit_required: true,
                                bit_inline: false,
                                arr_rules: [
                                    {
                                        type: 'empty',
                                        prompt: 'Please enter your name'
                                    }
                                ]
                            },
                            {
                                str_name: 'field-2',
                                str_caption: 'I agree to the terms and conditions',
                                str_kit: 'checkbox',
                                bit_required: false,
                                bit_inline: true
                            }
                        ]
                    }
                };
            },
            created: function () {
                var _self = this;
                console.log('APP.created: ');
            },
            mounted: function () {
                var _self = this;
                console.log('APP.mounted: ');
                Vue.nextTick(_self.___ready);
            },
            methods: {
                ___ready: function () {
                    var _self = this;
                    console.log('APP.ready: data = ', _self.objForm.arr_fields);

                    var obj_fields_valid = {};
                    if (_self.objForm && _self.objForm.arr_fields && Array.isArray(_self.objForm.arr_fields)) {
                        Array.from(_self.objForm.arr_fields).forEach(f_ => {
                            if (f_.str_name && f_.arr_rules && Array.isArray(f_.arr_rules)) {
                                obj_fields_valid[f_.str_name] = {
                                    identifier: f_.str_name,
                                    rules: f_.arr_rules
                                };
                            }
                        });
                    }

                    console.log('APP.ready: obj_fields_valid = ', obj_fields_valid);

                    $('.ui.form').form({ fields: obj_fields_valid });
                }
            }
        });
    </script>
</body>
</html>
